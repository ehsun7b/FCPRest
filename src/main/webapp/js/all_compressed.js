function loadGeneralNews(e,t){$.ajax({url:e,type:"GET"}).done(function(e){t(e)})}function loadOfficialNews(e){loadGeneralNews("/rest/news/json",e)}function loadArteshNews(e){loadGeneralNews("/rest/artesh/json",e)}function loadVarzesh3News(e){loadGeneralNews("/rest/varzesh3/json",e)}function loadIsnaNews(e){loadGeneralNews("/rest/isna/json",e)}function loadIrnaNews(e){loadGeneralNews("/rest/irna/json",e)}function loadKhabarOnlineNews(e){loadGeneralNews("/rest/khabaronline/json",e)}function showGeneralNews(e,t){t.html("");console.log(e);var n=Math.min(e.length,SIZE);for(var r=0;r<n;++r){var i=e[r];var s=$("<img/>",{src:"rest/image/news/"+i.uniqueKey+"/"+IMAGE_SIZE.width+"/"+IMAGE_SIZE.height});t.append($("<div/>",{"class":"news"}).append($("<a/>",{href:"/news/"+i.uniqueKey}).append(i.title)).append(s))}}function showOfficialNews(){$("#official_news_content").html("<div style='padding: 40px;text-align: center'>LOADING</div>");loadOfficialNews(function(e){console.log("show official news");showGeneralNews(e,$("#official_news_content"))})}function showArteshNews(){$("#artesh_news_content").html("<div style='padding: 40px;text-align: center'>LOADING</div>");loadArteshNews(function(e){showGeneralNews(e,$("#artesh_news_content"))})}function showVarzesh3News(){$("#varzesh3_news_content").html("<div style='padding: 40px;text-align: center'>LOADING</div>");loadVarzesh3News(function(e){showGeneralNews(e,$("#varzesh3_news_content"))})}function showIsnaNews(){$("#isna_news_content").html("<div style='padding: 40px;text-align: center'>LOADING</div>");loadIsnaNews(function(e){showGeneralNews(e,$("#isna_news_content"))})}function showKhabarOnlineNews(){$("#khabaronline_news_content").html("<div style='padding: 40px;text-align: center'>LOADING</div>");loadKhabarOnlineNews(function(e){showGeneralNews(e,$("#khabaronline_news_content"))})}function showRanking(e){getRanking(function(t){console.log(t);var n=t.table;$("#"+e).html($("<table/>",{id:"tblRanking"}));var r=$("<tr/>");r.append($("<th/>").append("ردیف"));r.append($("<th/>").append("تیم"));r.append($("<th/>").append("بازی"));r.append($("<th/>").append("برد"));r.append($("<th/>").append("مساوی"));r.append($("<th/>").append("باخت"));r.append($("<th/>").append("گل زده"));r.append($("<th/>").append("گل خورده"));r.append($("<th/>").append("تفاضل گل"));r.append($("<th/>").append("امتیاز"));$("#tblRanking").html(r);var i=n.length;for(var s=0;s<i;++s){var o=n[s];var u=$("<tr/>");u.append($("<td/>").append(s+1));u.append($("<td/>").append(o.team));u.append($("<td/>").append(o.matches));u.append($("<td/>").append(o.wins));u.append($("<td/>").append(o.draws));u.append($("<td/>").append(o.looses));u.append($("<td/>").append(o.scoredGoals));u.append($("<td/>").append(o.receivedGoals));u.append($("<td/>").append(o.differentGoals));u.append($("<td/>").append(o.points));$("#tblRanking").append(u)}})}function getRanking(e){$.ajax({url:"/rest/ranking/json",type:"GET"}).done(function(t){e(t)})}function showMatchInfoTabs(e,t){getMatchInfo(function(n){console.log(n);$("#"+t).html($("<table/>",{id:"tblPreMatchInfo"}));$("#"+e).html($("<table/>",{id:"tblNextMatchInfo"}));var r=$("<tr/>");var i=$("<tr/>");var s=$("<tr/>");var o=$("<tr/>");var u=$("<tr/>");var a=$("<tr/>");var f=$("<tr/>");var l=$("<tr/>");o.append($("<td/>",{id:"preMatchInfo",colspan:2}).append(n.preMatch.matchDescription));r.append($("<td/>",{id:"preHomeTeam"}).append(n.preMatch.homeTeam));r.append($("<td/>",{id:"preAwayTeam"}).append(n.preMatch.guestTeam));i.append($("<td/>",{id:"preHomeLogo"}).append($("<img/>",{src:n.preMatch.homeTeamLogo})));i.append($("<td/>",{id:"preAwayLogo"}).append($("<img/>",{src:n.preMatch.guestTeamLogo})));s.append($("<td/>",{id:"preHomeScore"}).append(n.preMatch.homeTeamScore));s.append($("<td/>",{id:"preAwayScore"}).append(n.preMatch.guestTeamScore));f.append($("<td/>",{id:"nextMatchInfo",colspan:2}).append(n.nextMatch.matchDescription));u.append($("<td/>",{id:"nextHomeTeam"}).append(n.nextMatch.homeTeam));u.append($("<td/>",{id:"nextAwayTeam"}).append(n.nextMatch.guestTeam));a.append($("<td/>",{id:"nextHomeLogo"}).append($("<img/>",{src:n.nextMatch.homeTeamLogo})));a.append($("<td/>",{id:"nextAwayLogo"}).append($("<img/>",{src:n.nextMatch.guestTeamLogo})));$("#tblPreMatchInfo").append(r);$("#tblPreMatchInfo").append(i);$("#tblPreMatchInfo").append(s);$("#tblPreMatchInfo").append(o);$("#tblNextMatchInfo").append(u);$("#tblNextMatchInfo").append(a);$("#tblNextMatchInfo").append(f)})}function showMatchInfo(e){getMatchInfo(function(t){console.log(t);$("#"+e).html($("<table/>",{id:"tblMatchInfo"}));var n=$("<tr/>");var r=$("<tr/>");var i=$("<tr/>");var s=$("<tr/>");var o=$("<tr/>");var u=$("<tr/>");var a=$("<tr/>");var f=$("<tr/>");var l=$("<tr/>");var c=$("<tr/>");n.append($("<td/>",{id:"preMatchTitle",colspan:2}).append("بازی قبلی"));o.append($("<td/>",{id:"preMatchInfo",colspan:2}).append(t.preMatch.matchDescription));r.append($("<td/>",{id:"preHomeTeam"}).append(t.preMatch.homeTeam));r.append($("<td/>",{id:"preAwayTeam"}).append(t.preMatch.guestTeam));i.append($("<td/>",{id:"preHomeLogo"}).append($("<img/>",{src:t.preMatch.homeTeamLogo})));i.append($("<td/>",{id:"preAwayLogo"}).append($("<img/>",{src:t.preMatch.guestTeamLogo})));s.append($("<td/>",{id:"preHomeScore"}).append(t.preMatch.homeTeamScore));s.append($("<td/>",{id:"preAwayScore"}).append(t.preMatch.guestTeamScore));u.append($("<td/>",{id:"nextMatchTitle",colspan:2}).append("بازی بعدی"));l.append($("<td/>",{id:"nextMatchInfo",colspan:2}).append(t.nextMatch.matchDescription));a.append($("<td/>",{id:"nextHomeTeam"}).append(t.nextMatch.homeTeam));a.append($("<td/>",{id:"nextAwayTeam"}).append(t.nextMatch.guestTeam));f.append($("<td/>",{id:"nextHomeLogo"}).append($("<img/>",{src:t.nextMatch.homeTeamLogo})));f.append($("<td/>",{id:"nextAwayLogo"}).append($("<img/>",{src:t.nextMatch.guestTeamLogo})));$("#tblMatchInfo").append(n);$("#tblMatchInfo").append(r);$("#tblMatchInfo").append(i);$("#tblMatchInfo").append(s);$("#tblMatchInfo").append(o);$("#tblMatchInfo").append(u);$("#tblMatchInfo").append(a);$("#tblMatchInfo").append(f);$("#tblMatchInfo").append(l)})}function getMatchInfo(e){$.ajax({url:"/rest/matchinfo/json",type:"GET"}).done(function(t){e(t)})}function getNewspaperPhotos(e){$.ajax({url:"/rest/newspaper/photos",type:"GET"}).done(function(t){e(t)})}function showAllNewspaperThumbnails(e,t){getNewspaperPhotos(function(n){var r=n.length;if(r>0){var i=$("<div/>",{id:"newspapers-thumbnails"});$(i).hide();for(var s=0;s<r;++s){var o=n[s];var u=$("<img/>",{src:"/rest/image/thumbnail/"+t.width+"/"+t.height+"?url="+o,width:t.width,height:t.height,onclick:"showNewspaper('"+n[s]+"')"});i.append(u)}$("#"+e).append(i);$("#"+e).mouseenter(function(){$("#newspapers-thumbnails").fadeIn();$("#newspapers-thumbnails").css({"z-index":1e3})});$("#"+e).mouseleave(function(){$("#newspapers-thumbnails").fadeOut()})}showAnimatedNewspapers("newspaper_thumbnail",n,NEWSPAPER_THUMBNAIL_SIZE);$("#newspaper").css({visibility:"visible"})})}function showNewspaper(e){window.open("/rest/image/?url="+encodeURIComponent(e),"_blank")}function showAnimatedNewspapers(e,t,n){var r=[];var i=t.length;for(var s=0;s<i;++s){var o=new Image;r.push(o);t[s]="/rest/image/thumbnail/"+n.width+"/"+n.height+"?url="+encodeURIComponent(t[s])}var u=new Kinetic.Stage({container:e,width:n.width,height:n.height});layer=new Kinetic.Layer;o=new Array(r.length);for(var s=0;s<i;++s){r[s].onload=function(e){return function(){console.log("image "+e+" loaded: "+r[e].src);o[e]=new Kinetic.Image({x:0,y:0,image:r[e],width:n.width,height:n.height});layer.add(o[e]);o[e].moveToBottom();layer.draw();o[e].on("mouseover",function(){pdf.moveToTop();layer.draw()});o[e].on("mouseout",function(){pdf.moveToBottom();layer.draw()})}}(s);r[s].src=t[s];console.log("src: "+t[s])}pdf=new Kinetic.Text({x:30,y:26,text:"PDF",stroke:"#000",strokeWidth:2,fontSize:40,fontFamily:"Times New Roman",fontStyle:"bold",fill:"#f00",align:"center",shadowColor:"black",shadowBlur:2,shadowOffset:{x:3,y:3},shadowOpacity:.4,opacity:.6});pdf.on("mouseover",function(){pdf.moveToTop();layer.draw()});layer.add(pdf);u.add(layer);layer.draw();setInterval(function(){if(o[index]!==undefined){o[index].moveToTop();layer.draw();if(index<o.length-1){index++}else{index=0}}},3e3)}function NewsBoard(e){function y(){var e=n[0];if(e===undefined||e===null){console.log("News not found!");return}a=new Kinetic.Text({text:E(e.title),x:v.width()/2,y:10,fontFamily:"tahoma",fontSize:12,fill:"blue",align:"right",opacity:1});a.x(v.width()-a.width()-10);f=new Kinetic.Text({text:E(w(e.description,r)),x:v.width()/2,y:30,fontFamily:"tahoma",fontSize:12,fill:"black",align:"right",lineHeight:1.5,opacity:1});f.x(v.width()-f.width()-10);a.on("mouseover",function(e){$(document.body).css({cursor:"pointer"})});a.on("mouseout",function(e){$(document.body).css({cursor:"default"})});a.on("click",function(e){window.open(n[c].link)});if(e.image!==undefined&&e.image!==null){if(e.imageInfo.loaded){b(e.imageInfo.img,m)}else{var t=new Image;t.addEventListener("load",function(){b(t,m)});t.src=e.image}}m.add(a);m.add(f)}function b(e,t){var n=S(e);u=new Kinetic.Image({x:10,y:10,width:n.width,height:n.height,image:e,stroke:"black",strokeWidth:1,opacity:1});t.add(u);t.drawScene()}function w(e,t){var n="";var r=e.length;var i=0;for(var s=0;s<r;++s){if(i>=t&&e[s]===" "){n+="\n";i=0}n+=e[s];i++}return n}function E(e){try{var t=e.length;if(e[t-1]==="."||e[t-1]==="!"||e[t-1]==="?"){return e.substr(0,t-1)}}catch(n){console.log("Error in fixText: "+n)}return e}function S(e){var t=null;if(e.width<=o.width&&e.height<=o.height){return o}else{if(e.width>o.width){var n=o.width/e.width;var t={width:o.width,height:e.height*n}}if(e.height>o.height||t.height>o.height){var n=o.height/e.height;var t={height:o.height,width:e.width*n}}}return t}function x(){l=setInterval(function(){if(c<n.length-1){c++}else{c=0}var e={x:a.x(),y:a.y()};var t={x:f.x(),y:f.y()};var i={x:u.x(),y:u.y()};var s=new Kinetic.Animation(function(e){if(e.time<50){a.y(a.y()+3)}else if(e.time<100){a.y(a.y()+3)}else if(e.time<400){a.y(a.y()-4);if(a.opacity()>.1){a.opacity(a.opacity()-.1)}}else{this.stop();a.opacity(0)}},m);var o=new Kinetic.Animation(function(e){if(e.time<50){f.x(f.x()-4)}else if(e.time<100){f.x(f.x()-6)}else if(e.time<500){f.x(f.x()+12);if(f.opacity()>.1){f.opacity(f.opacity()-.1)}}else if(e.time<700){f.x(f.x()+18);if(f.opacity()>.1){f.opacity(f.opacity()-.1)}}else{this.stop();f.opacity(0)}},m);var l=new Kinetic.Animation(function(e){if(e.time<50){u.x(u.x()+5)}else if(e.time<100){u.x(u.x()+7)}else if(e.time<500){u.x(u.x()-10);if(u.opacity()>.1){u.opacity(u.opacity()-.1)}}else{this.stop();u.opacity(0)}},m);s.start();o.start();l.start();setTimeout(function(){var s=n[c];a.text(E(s.title));f.text(E(w(s.description,r)));if(s.imageInfo.loaded){var o=S(s.imageInfo.img);u.image(s.imageInfo.img);u.width(o.width);u.height(o.height);u.x(i.x);u.y(i.y)}else{var l=new Image;l.addEventListener("load",function(){var e=S(l);u.image(l);u.width(e.width);u.height(e.height);u.x(i.x);u.y(i.y)});l.src=s.image}a.x(v.width()-a.width()-10);a.y(e.y);f.x(v.width()-f.width()-10);f.y(t.y);a.opacity(1);f.opacity(1);u.opacity(1);m.draw();v.draw()},1e3)},i)}try{var t=e.container;var n=e.newsList;var r=e.maxTextWidth;var i=e.interval;var s=e.size;var o=e.imageSize;var u,a,f;var l;var c=0;var h=n.length;for(var p=0;p<h;++p){var d=new Image;n[p].imageInfo={loaded:false,img:d};n[p].imageInfo.img.onload=function(e){return function(){n[e].imageInfo.loaded=true;console.log("image of board loaded: "+e+" src: "+n[e].imageInfo.img.src)}}(p);n[p].imageInfo.img.src=n[p].image}if(Kinetic===undefined){alert("kineticJS is not loaded!");return}var v=new Kinetic.Stage({container:t,width:s.width,height:s.height});var m=new Kinetic.Layer;y();v.add(m);m.draw();x()}catch(g){console.log("Error: "+g)}this.initLayer2=function(){}}function NewsBoard2(e){function d(){a[f].visible(true);h.drawScene();console.log("length "+a.length);if(f<a.length-1){f++;console.log("increment index: "+f)}else{f=0;console.log("index become 0: "+f)}}function v(){var e=new Kinetic.Rect({x:c.width()/2-35,y:c.height()/2-10,width:70,height:20,fill:"#AAA"});h.add(e);var t=new Kinetic.Text({x:c.width()/2-20,y:c.height()/2-4,text:"LOADING",fontSize:8,fontFamily:"arial",fontStyle:"bold",fill:"white",align:"center"});h.add(t);h.drawScene()}function m(e){var t=n.length;for(var r=0;r<t;++r){var i=new Image;n[r].imageInfo={loaded:false,img:i};n[r].imageInfo.img.onload=function(t){return function(){n[t].imageInfo.loaded=true;u++;console.log("image of board loaded: "+t+" src: "+n[t].imageInfo.img.src);if(u===n.length){e()}}}(r);n[r].imageInfo.img.src=n[r].image}}function g(){var e=n.length;for(var t=0;t<e;++t){var r=n[t];var i=new Kinetic.Group({x:0,y:0,width:c.width(),height:c.height(),visible:false});var s=new Kinetic.Rect({x:i.x(),y:i.y(),width:i.width(),height:i.height(),fill:y(),stroke:"#aaa",strokeWidth:1});i.add(s);var o=new Kinetic.Text({x:c.width()/2-20,y:c.height()/2-4,text:w(r.title),fontSize:12,fontFamily:"tahoma",fontStyle:"normal",fill:"blue",align:"right"});o.x(i.width()-o.width()-10);i.add(o);a[t]=i;h.add(i)}}function y(){return"#aaa"}function b(e,t){var n="";var r=e.length;var i=0;for(var s=0;s<r;++s){if(i>=t&&e[s]===" "){n+="\n";i=0}n+=e[s];i++}return n}function w(e){try{var t=e.length;if(e[t-1]==="."||e[t-1]==="!"||e[t-1]==="?"){return e.substr(0,t-1)}}catch(n){console.log("Error in fixText: "+n)}return e}function E(e){var t=null;if(e.width<=o.width&&e.height<=o.height){return o}else{if(e.width>o.width){var n=o.width/e.width;var t={width:o.width,height:e.height*n}}if(e.height>o.height||t.height>o.height){var n=o.height/e.height;var t={height:o.height,width:e.width*n}}}return t}try{var t=e.container;var n=e.newsList;var r=e.maxTextWidth;var i=e.interval;var s=e.size;var o=e.imageSize;var u=0;var a=[];var f=0;var l=null;if(Kinetic===undefined){alert("kineticJS is not loaded!");return}var c=new Kinetic.Stage({container:t,width:s.width,height:s.height});var h=new Kinetic.Layer;v();c.add(h);h.draw();m(function(){g();h.removeChildren();d();setInterval(function(){d()},i)})}catch(p){console.log("Error! "+p)}}function mapInitialize(){var e="ورزشگاه آزادی";var t="https://www.google.com/maps/place/Azadi+Stadium/@35.7245193,51.2716583,17z/data=!4m6!1m3!3m2!1s0x3f8dfc859879296d:0xc0312cba0be26197!2sAzadi+Sport+Complex!3m1!1s0x0:0x14589609944afeba";var n=new google.maps.LatLng(point.latitude,point.longitude);var r={zoom:14,center:n,draggable:true};map=new google.maps.Map(document.getElementById("map-canvas"),r);var i=new google.maps.Marker({position:n,map:map,title:e});google.maps.event.addListener(map,"click",function(){window.location.href=t})}function showTravelingTime(e){if(navigator.geolocation){console.log("getting geo location");navigator.geolocation.getCurrentPosition(function(t){console.log(t);var n=t.coords;$.ajax({url:"/rest/direction/json/"+n.latitude+"/"+n.longitude+"/"+point.latitude+"/"+point.longitude+"/true",type:"get"}).done(function(t){var n=t.meters;if(n>0){var r=n/1e3;if(r>0){e.html(r+" کیلومتر")}else{e.html(n+" متر")}}})},function(e){alert("error: "+e.code+" "+e.message)},{maximumAge:6e5,timeout:5e3,enableHighAccuracy:true})}else{console.log("no geo location support")}}var SIZE=10;var IMAGE_SIZE={width:80,height:80};$(function(){});$(function(){showRanking("ranking");showMatchInfoTabs("tab2","tab4")});var NEWSPAPER_THUMBNAIL_SIZE={width:138,height:100};var NEWSPAPERS_THUMBNAIL_SIZE={width:100,height:60};var img,pdf,layer;var index=0;$(function(){showAllNewspaperThumbnails("newspaper",NEWSPAPERS_THUMBNAIL_SIZE)});var map;var point={latitude:35.7245193,longitude:51.2716583};$(function(){$("#btnDistance").click(function(){$("#distance").html("LOADING");showTravelingTime($("#distance"))})})